product: MOTOR_PRIVATE
version: 2024_09
currency: EUR

nodes:
  driver_age:
    type: INPUT
    dtype: decimal

  brand:
    type: INPUT
    dtype: str

  density:
    type: INPUT
    dtype: decimal

  base_premium:
    type: CONSTANT
    value: 500

  driver_factor:
    type: LOOKUP
    table: driver_age_factor
    key_node: driver_age
    mode: range

  vehicle_category:
    type: LOOKUP
    table: vehicle_brand_category
    key_node: brand
    mode: exact

  vehicle_category_factor:
    type: LOOKUP
    table: vehicle_brand_coefs
    key_node: vehicle_category
    mode: exact

  density_factor:
    type: IF
    condition: density > 1000
    then: 1.20
    else: 1.00

  technical_premium:
    type: MULTIPLY
    inputs:
      - base_premium
      - driver_factor
      - vehicle_category_factor
      - density_factor

  fee:
    type: CONSTANT
    value: 25

  raw_total_premium:
    type: ADD
    inputs:
      - technical_premium
      - fee

  total_premium:
    type: ROUND
    input: raw_total_premium
    decimals: 2
    mode: HALF_UP
