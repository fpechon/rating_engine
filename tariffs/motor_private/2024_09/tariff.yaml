product: MOTOR_PRIVATE
version: 2024_09
currency: EUR

# Tables de lookup utilisÃ©es par le tarif
tables:
  driver_age_factor:
    type: range
    source: tables/driver_age_factor.csv

  zoning:
    type: exact
    source: tables/zoning.csv
    key_column: neighbourhood_id
    value_column: zone
    key_type: int

  zoning_coefs:
    type: exact
    source: tables/zoning_coefs.csv
    key_column: key
    value_column: value

  vehicle_brand_category:
    type: exact
    source: tables/vehicle_brand_category.csv
    key_column: key
    value_column: value

  vehicle_brand_coefs:
    type: exact
    source: tables/vehicle_brand_coefs.csv
    key_column: key
    value_column: value

nodes:
  driver_age:
    type: INPUT
    dtype: decimal

  brand:
    type: INPUT
    dtype: str

  density:
    type: INPUT
    dtype: decimal

  neighbourhood_id:
    type: INPUT
    dtype: str

  base_premium:
    type: CONSTANT
    value: 500

  driver_factor:
    type: LOOKUP
    table: driver_age_factor
    key_node: driver_age
    mode: range

  zoning_factor:
    type: LOOKUP
    table: zoning
    key_node: neighbourhood_id
    mode: exact

  zoning_coef:
    type: LOOKUP
    table: zoning_coefs
    key_node: zoning_factor
    mode: exact

  vehicle_category:
    type: LOOKUP
    table: vehicle_brand_category
    key_node: brand
    mode: exact

  vehicle_category_factor:
    type: LOOKUP
    table: vehicle_brand_coefs
    key_node: vehicle_category
    mode: exact

  density_factor:
    type: IF
    condition: density > 1000
    then: 1.20
    else: 1.00

  technical_premium:
    type: MULTIPLY
    inputs:
      - base_premium
      - driver_factor
      - vehicle_category_factor
      - density_factor
      - zoning_coef

  fee:
    type: CONSTANT
    value: 25

  raw_total_premium:
    type: ADD
    inputs:
      - technical_premium
      - fee

  total_premium:
    type: ROUND
    input: raw_total_premium
    decimals: 2
    mode: HALF_UP
